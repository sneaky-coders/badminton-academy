


<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=0"
    />
    <title>Badminton Academy</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@10">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>

    <!-- Meta Tags -->
    <meta
      name="twitter:description"
      content="Elevate your badminton business with Dream Sports template. Empower coaches & players, optimize court performance and unlock industry-leading success for your brand."
    />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta
      name="description"
      content="Elevate your badminton business with Dream Sports template. Empower coaches & players, optimize court performance and unlock industry-leading success for your brand."
    />
    <meta
      name="keywords"
      content="badminton, coaching, event, players, training, courts, tournament, athletes, courts rent, lessons, court booking, stores, sports faqs, leagues, chat, wallet, invoice"
    />
    <meta name="author" content="Dreamguys - Badminton Academy" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@dreamguystech" />
    <meta
      name="twitter:title"
      content="Badminton Academy -  Booking Coaches, Venue for tournaments, Court Rental template"
    />

    <meta name="twitter:image" content="assets/img/meta-image.jpg" />
    <meta name="twitter:image:alt" content="Badminton Academy" />

    <meta property="og:url" content="https://Badminton Academy.dreamguystech.com/" />
    <meta
      property="og:title"
      content="Badminton Academy -  Booking Coaches, Venue for tournaments, Court Rental template"
    />
    <meta
      property="og:description"
      content="Elevate your badminton business with Dream Sports template. Empower coaches & players, optimize court performance and unlock industry-leading success for your brand."
    />
    <meta property="og:image" content="/assets/img/meta-image.jpg" />
    <meta property="og:image:secure_url" content="assets/img/meta-image.jpg" />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="600" />

    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="assets/img/favicon.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="120x120"
      href="assets/img/apple-touch-icon-120x120.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="152x152"
      href="assets/img/apple-touch-icon-152x152.png"
    />

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />

    <!-- Fontawesome CSS -->
    <link
      rel="stylesheet"
      href="assets/plugins/fontawesome/css/fontawesome.min.css"
    />
    <link rel="stylesheet" href="assets/plugins/fontawesome/css/all.min.css" />

    <!-- Select CSS -->
    <link rel="stylesheet" href="assets/plugins/select2/css/select2.min.css" />

    <!-- Feathericon CSS -->
    <link rel="stylesheet" href="assets/css/feather.css" />

    <!-- Main CSS -->
    <link rel="stylesheet" href="assets/css/style.css" />
  </head>

  <body>
    <div id="global-loader">
      <div class="loader-img">
        <img src="assets/img/loader.png" class="img-fluid" alt="Global" />
      </div>
    </div>

    <!-- Main Wrapper -->
    <div class="main-wrapper">
      <!-- Header -->
    		<header class="header header-trans">
			<div class="container-fluid">
				<nav class="navbar navbar-expand-lg header-nav">
					<div class="navbar-header">
						<a id="mobile_btn" href="javascript:void(0);">
							<span class="bar-icon">
								<span></span>
								<span></span>
								<span></span>
							</span>
						</a>
						<a href="index.html" class="navbar-brand logo">
							<img src="assets/img/logo.svg" class="img-fluid" alt="Logo">
						</a>
					</div>
					<div class="main-menu-wrapper">
						<div class="menu-header">
							<a href="index.html" class="menu-logo">
								<img src="assets/img/logo-black.svg" class="img-fluid" alt="Logo">
							</a>
							<a id="menu_close" class="menu-close" href="javascript:void(0);"> <i class="fas fa-times"></i></a>
						</div>
						<ul class="main-nav">
							<li class="active"><a href="index.html">Home</a></li>
							
							
							
						
							<li><a href="court-booking.html">Book A Court</a></li>
							<li><a href="#">About Us</a></li>
							<li><a href="#">Venues</a></li>
							<li><a href="contact-us.html">Contact Us</a></li>
							<li class="login-link">
								<a href="register.html">Sign Up</a>
							</li>
							<li class="login-link">
								<a href="login.html">Sign In</a>
							</li>
						</ul>
					</div>
					<ul class="nav header-navbar-rht">
						<li class="nav-item">
							<div class="nav-link btn btn-white log-register">
								<a href="backend/web"><span><i class="feather-users"></i></span>Login</a> / <a href="register.html">Register</a>
							</div>
						</li>
						
					</ul>
				</nav>
			</div>
		</header>
      <!-- /Header -->

      <!-- Breadcrumb -->
      <div class="breadcrumb mb-0">
        <div class="container">
          <h1 class="text-white">Book A Court</h1>
          <ul>
            <li><a href="index.html">Home</a></li>
            <li>Book A Court</li>
          </ul>
        </div>
      </div>
      <!-- /Breadcrumb -->
      <section class="booking-steps py-30">
        <span class="primary-right-round"></span>
        <div class="container">
          <ul class="d-lg-flex justify-content-center align-items-center">
            <li>
              <h5>
                <a href="cage-details.html"><span>1</span>Book a Court</a>
              </h5>
            </li>
            <li class="active">
              <h5>
                <a href="cage-personalinfo.html"
                  ><span>2</span>Personal Information</a
                >
              </h5>
            </li>
            <li>
              <h5>
                <a href="cage-order-confirm.html"
                  ><span>3</span>Order Confirmation</a
                >
              </h5>
            </li>

            <li>
              <h5>
                <a href="cage-checkout.html"><span>4</span>Payment</a>
              </h5>
            </li>
          </ul>
        </div>
      </section>

      <!-- Page Content -->
      <div class="content book-cage">
        <div class="container">
          <section class="mb-40">
            <div class="text-center mb-40">
              <h3 class="mb-1">Personal Information</h3>
              <p class="sub-title mb-0">
                Share your info and embark on a sporting journey.
              </p>
            </div>
            <div class="card">
              <h3 class="border-bottom">Enter Details</h3>
              <!-- Your HTML form in booking.html -->
              <form method="POST" action="">
        <!-- Other form fields for court details -->

        <!-- Assuming $id is available in your PHP script -->
       

        <input type="hidden" name="id" value="<?php echo $id; ?>">

        <div class="mb-3">
            <label for="name" class="form-label">Name</label>
            <input type="text" name="namee" class="form-control" id="name" placeholder="Enter Name">
        </div>
        <div class="mb-3">
            <label for="email" class="form-label">Email</label>
            <input type="email" name="email" class="form-control" id="email" placeholder="Enter Email Address">
        </div>
        <div class="mb-3">
            <label for="name" class="form-label">Phone Number</label>
            <input name="contact" class="form-control" id="phonenumber" type="tel" pattern="[0-9]{10}" placeholder="Enter Phone Number" required>

        </div>
        <div class="mb-3">
            <label for="name" class="form-label">Your Address</label>
            <input type="text" name="address" class="form-control" id="address" placeholder="Enter Address">
        </div>

        <button type="submit" class="btn btn-secondary btn-icon mt-3">
            Next <i class="feather-arrow-right-circle ms-1"></i>
        </button>
    </form>
			
            </div>
          </section>
        </div>
        <!-- Container -->
      </div>
      <!-- /Page Content -->

      <!-- Footer -->
      <footer class="footer">
			<div class="container">
				<!-- Footer Join -->
				<div class="footer-join aos" data-aos="fade-up">
					<h2>We Welcome Your Passion And Expertise</h2>
					<p class="sub-title">Join our empowering sports community today and grow with us.</p>
					<a href="register.html" class="btn btn-primary"><i class="feather-user-plus"></i> Join With Us</a>
				</div>
				<!-- /Footer Join -->
			
				<!-- Footer Top -->
				
				<!-- /Footer Top -->
			</div>
			
			<!-- Footer Bottom -->
			<div class="footer-bottom">
				<div class="container">
					<!-- Copyright -->
					<div class="copyright">
						<div class="row align-items-center">
							<div class="col-md-6">
								<div class="copyright-text">
									<p class="mb-0">&copy; 2023 Badminton Academy  - All rights reserved. Designed With ❤️ By <a href="https://createmysite.co.in" target="_blank">Create My Site</a></p>
								</div>
							</div>
							
						</div>
					</div>
					<!-- /Copyright -->
				</div>
			</div>
			<!-- /Footer Bottom -->
			
		</footer>
      <!-- /Footer -->
    </div>
    <!-- /Main Wrapper -->

    <!-- jQuery -->
    <script src="assets/js/jquery-3.7.0.min.js"></script>

    <!-- Bootstrap Core JS -->
    <script src="assets/js/bootstrap.bundle.min.js"></script>

    <!-- Select JS -->
    <script src="assets/plugins/select2/js/select2.min.js"></script>

    <!-- Custom JS -->
    <script src="assets/js/script.js"></script>
  </body>
</html>
<?php
// Start output buffering to prevent headers already sent error
ob_start();

// Start the session
session_start();

// Include the file with the MySQL database connection
include 'connection.php';

// Enable error reporting for debugging
error_reporting(E_ALL);
ini_set('display_errors', 1);

// Check the database connection
if ($conn->connect_error) {
    die("Connection failed: " . $conn->connect_error);
}

// Check if the session data is still valid
if (isset($_SESSION['last_page']) && $_SESSION['last_page'] !== basename($_SERVER['PHP_SELF'])) {
    // User navigated back or accessed a different page
    // Clear relevant session data
    unset($_SESSION['booking_success']);
    unset($_SESSION['booking_data']);
    unset($_SESSION['booking_error']);
}

// Store the current page in the session
$_SESSION['last_page'] = basename($_SERVER['PHP_SELF']);

// Initialize or retrieve the ID from the GET parameter
$id = isset($_GET['id']) ? (int)$_GET['id'] : 0;

// Check if the request method is POST
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    // Retrieve form data
    $name = $_POST['namee'];
    $email = $_POST['email'];
    $contact = $_POST['contact'];
    $address = $_POST['address'];

    // Validate form data
    if (empty($name) || empty($email) || empty($contact) || empty($address)) {
        $_SESSION['booking_error'] = 'All fields are required. Please fill out the form completely.';
        echo "<script>window.location.href = 'court-booking.html';</script>";
        exit();
    }

    // Use prepared statement to prevent SQL injection
    $sql = "UPDATE court
            SET name = ?, email = ?, contact = ?, address = ?
            WHERE id = ?";

    $stmt = $conn->prepare($sql);

    // Bind parameters
    $stmt->bind_param("ssssi", $name, $email, $contact, $address, $id);

    // Execute the statement
    if ($stmt->execute()) {
        // Clear session variables
        $_SESSION['booking_success'] = true;
        unset($_SESSION['booking_data']);

        // Redirect to the confirmation page using JavaScript
        echo "<script>window.location.href = 'booking-confirm.php?id=$id';</script>";
        exit();
    } else {
        $_SESSION['booking_error'] = 'Error updating record: ' . $stmt->error;
        echo "<script>window.location.href = 'court-booking.html';</script>";
        exit();
    }

    // Close the prepared statement
    $stmt->close();
} else {
    // Save form data in session if it's not a POST request
    $_SESSION['booking_data'] = [
        'name' => $_POST['namee'] ?? '',
        'email' => $_POST['email'] ?? '',
        'contact' => $_POST['contact'] ?? '',
        'address' => $_POST['address'] ?? '',
    ];
}

// Close the database connection
$conn->close();

// End output buffering and flush the output
ob_end_flush();
?>
